 	.syntax unified
 	.cpu cortex-m3
 	.thumb
 	.align 2
 	.global	classification
 	.thumb_func

@ CG2028 Assignment, Sem 2, AY 2021/21
@ (c) CG2028 Teaching Team, ECE NUS, 2021

@ student 1: Name: Nigel Ng, Matriculation No.: A0217408H
@ student 2: Name: , Matriculation No.:
@ eg: student 1: Name: John Doe , Matriculation No.: A021234N

@Register map
@R0 - N, returns class
@R1 - points
@R2 - label
@R3 - sample
@R4 - register for calculation
@R5 - register for calculation
@R6 - general purpose register for writing/ reading
@R7 - general purpose register for writing/ reading
@R8 - intermediate register for storing count

classification:
@ PUSH / save (only those) registers which are modified by your function
		PUSH {R1-R8,R14}
@ parameter registers need not be saved.

@ write asm function body here

@ extract N into register 8 for comparison later.
LDR R8, [R0] @extract N into R8

@ extract sample_x
LDR R7, [R3]	@extract value of x
LDR R6, =sample_x
STR R7, [R6]

@ extract sample_y
LDR R7, [R3,#4]	@extract value of y
LDR R6, =sample_y
STR R7, [R6]

LOOP:

	SUBS R8, #1
	BGT LOOP

@ prepare value to return (class) to C program in R0
BL RETURN_VALUE


@ branch to GET_EUCLIDEAN TO check if curr_distance is smaller than min_distance
		@BL GET_EUCLIDEAN
@ gets euclidean distance,
@ updates min_distance accordingly

@ increment count, check if count == N. if so, go to next line

@ POP / restore original register values. DO NOT save or restore R0. Why?
		POP {R1-R8,R14}
@ return to C program
		BX	LR

@gets the euclidean distance of current point of reference and sample.
GET_EUCLIDEAN:
		BX LR

@sets R0 to the class
RETURN_VALUE:
		LDR R7,=sample_y	@test reading values
		LDR R0, [R7]
		BX LR
@label: .word value


@.lcomm label num_bytes - these values are important and thus are stored as static variables
.lcomm sample_x 4
.lcomm sample_y 4
.lcomm curr_distance 4
.lcomm min_distance 4
.lcomm curr_class 1
